<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../bower_components/vaadin-form-layout/vaadin-form-layout.html">
<link rel="import" href="../../bower_components/vaadin-form-layout/vaadin-form-item.html">
<link rel="import" href="../../bower_components/iron-form/iron-form.html">
<link rel="import" href="../styles/elith-styles.html">
<link rel="import" href="../elith-icons.html">


<script src="../../bower_components/json.date-extensions/json.date-extensions.js"></script>
<script>
  JSON.useDateParser()
</script>


<dom-module id="elith-client-form">
    <template>
        <style include="elith-styles">
            :host {
                display: block;
                padding: 10px;
            }

            .flex-horizontal-with-ratios {
                @apply --layout-horizontal;
            }

            .flexchild {
                @apply --layout-flex;
            }

            .flex2child {
                @apply --layout-flex-2;
            }


            .clientNameHeader{
                border-bottom: 2px solid;
                margin-bottom: 40px;
            }
            .clientNameHeader h1{
                display: inline;
            }
            .clientNameHeader paper-icon-button{
                display: inline-flex;
            }

        </style>


        <fieldset>
            <legend>Renseignements personnels</legend>
            <vaadin-form-layout>

                <paper-input label="Nom" value="{{client.nom}}" disabled$="[[!edition]]" auto-validate required></paper-input>
                <paper-input label="Prénom" value="{{client.prenom}}" disabled$="[[!edition]]" auto-validate required></paper-input>
                <paper-input label="Naissance" value="{{client.dateNaissanceString}}" disabled$="[[!edition]]" auto-validate
                             pattern="^(0?[1-9]|[12][0-9]|3[01])[\-](0?[1-9]|1[012])[\-](19|20)\d{2}$" error-message="Utiliser le format jj-mm-aaaa"></paper-input>
                <br>
                <paper-textarea label="Adresse" value="{{client.adresse}}" disabled$="[[!edition]]"></paper-textarea>
                <paper-input label="Ville" value="{{client.ville}}" disabled$="[[!edition]]"></paper-input>
                <br>

                <paper-input label="Téléphone" value="{{client.telephone}}" disabled$="[[!edition]]"></paper-input>
                <paper-input label="Courriel" value="{{client.email}}" disabled$="[[!edition]]" auto-validate type="email"></paper-input>

                <br>
                <paper-input label="Enfant(s)" value="{{client.enfants}}" disabled$="[[!edition]]" auto-validate pattern="[0-9]*" error-message="Veuillez saisir un chiffre"></paper-input>
                <br>
                <paper-input label="Emploi" value="{{client.emploi}}" disabled$="[[!edition]]"></paper-input>
                <paper-input label="Loisirs" value="{{client.loisirs}}" disabled$="[[!edition]]"></paper-input>
                <br>
            </vaadin-form-layout>
        </fieldset>
    <fieldset>
        <legend>Informations médicales</legend>
        <vaadin-form-layout>
            <paper-textarea label="Autres thérapies" value="{{client.autresTherapies}}" disabled$="[[!edition]]"></paper-textarea>
            <paper-textarea label="Médicaments" value="{{client.medicaments}}" disabled$="[[!edition]]"></paper-textarea>
            <paper-textarea label="Compléments" value="{{client.complements}}" disabled$="[[!edition]]"></paper-textarea>
            <paper-textarea label="Constipation" value="{{client.constipation}}" disabled$="[[!edition]]"></paper-textarea>
            <br>
            <paper-textarea label="Allergies" value="{{client.allergies}}" disabled$="[[!edition]]"></paper-textarea>
            <paper-textarea label="Opérations" value="{{client.operations}}" disabled$="[[!edition]]"></paper-textarea>
            <br>
            <paper-textarea label="Autre" value="{{client.autre}}" disabled$="[[!edition]]"></paper-textarea>
            <br>

            <paper-toggle-button checked="{{client.cardiaque}}" disabled="[[!edition]]">Cardiaque</paper-toggle-button>
            <paper-toggle-button checked="{{client.asthme}}" disabled="[[!edition]]">Asthme</paper-toggle-button>
            <paper-toggle-button checked="{{client.hypoglycemie}}" disabled="[[!edition]]">Hypoglycémie</paper-toggle-button>
            <paper-toggle-button checked="{{client.diabete}}" disabled="[[!edition]]">Diabète</paper-toggle-button>
            <paper-toggle-button checked="{{client.peau}}" disabled="[[!edition]]">Problème de peau</paper-toggle-button>
            <paper-toggle-button checked="{{client.fumeur}}" disabled="[[!edition]]">Fumeur</paper-toggle-button>
            <paper-toggle-button checked="{{client.osteoporose}}" disabled="[[!edition]]">Ostéporose</paper-toggle-button>
            <paper-toggle-button checked="{{client.arthrose}}" disabled="[[!edition]]">Arthrose</paper-toggle-button>
        </vaadin-form-layout>
    </fieldset>
    <fieldset>
        <legend>Notes du thérapeute</legend>
        <vaadin-form-layout>
            <paper-textarea label="Historique de la douleur" value="{{client.histoDouleur}}" disabled$="[[!edition]]"></paper-textarea>
            <paper-input label="Référé par" value="{{client.refer}}" disabled$="[[!edition]]"></paper-input>
            <br>
            <paper-textarea label="Constatations" value="{{client.constatations}}" disabled$="[[!edition]]"></paper-textarea>
            <br>
            <paper-textarea label="Attention" value="{{client.attentions}}" disabled$="[[!edition]]"></paper-textarea>
            <paper-textarea label="À ne pas masser" value="{{client.pasMasser}}" disabled$="[[!edition]]"></paper-textarea>
            <br>
            <paper-textarea label="Note" value="{{client.note}}" disabled$="[[!edition]]"></paper-textarea>
            <br>
        </vaadin-form-layout>
    </fieldset>

</template>

    <script>
      class ElithClientform extends Polymer.Element {
        static get is () {
          return 'elith-client-form'
        }

        static get properties () {
          return {
            client: {
              type: Object,
            },
            edition: {
              observer: 'editionChanged'
            }

          }
        }

        editionChanged(modeEdition){
          let fieldsets = Polymer.dom(this.root).querySelectorAll('fieldset');
          if(modeEdition){
            for (let i=0; i<fieldsets.length; i++) {
              // assigns style properties
              fieldsets[i].classList.add('card-form');
            }
          }else{
            for (let i=0; i<fieldsets.length; i++) {
              // assigns style properties
              fieldsets[i].classList.remove('card-form');
            }
          }
        }

        formatDate(date){
         return Elith.Utils.formatDate(date);
        }

      }


      window.customElements.define(ElithClientform.is, ElithClientform)
    </script>
</dom-module>
