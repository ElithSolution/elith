<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../styles/elith-styles.html">

<script src="../../bower_components/json.date-extensions/json.date-extensions.js"></script>
<script>
  // use date parser for all JSON.parse() requests
  // make sure to call before any JSON conversions
  JSON.useDateParser()
</script>

<dom-module id="elith-clientdetail">
    <template>
        <style include="elith-styles">
            :host {
                display: block;
                padding: 10px;
            }

            .details {
                padding: 10px;
                margin: 10px;
                justify-content: space-around;
                align-items: center;
                box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14);
                display: block;
            }
        </style>



    <dom-if if="{{hasResult}}">
        <template>
            <div class="card">
                <span> Nom :  [[resultat.items.0.client.nom]] </span><br>
                <span> Prénom :  [[resultat.items.0.client.prenom]] </span><br>
                <span> Adresse :  [[resultat.items.0.client.adresse]] </span><br>
                <span> Ville :  [[resultat.items.0.client.ville]] </span><br>
                <span> Téléphone :  [[resultat.items.0.client.telephone]] </span><br>
                <span> Email :  [[resultat.items.0.client.email]] </span><br>
                <span> Date de naissance :  [[formatDate(resultat.items.0.client.dateNaissance)]] </span><br>
                <span> Enfants :  [[resultat.items.0.client.enfants]] </span><br>
                <span> Emploi :  [[resultat.items.0.client.emploi]] </span><br>
                <span> Loisirs :  [[resultat.items.0.client.loisirs]] </span><br>
                <span> Historique de la douleur :  [[resultat.items.0.client.histoDouleur]] </span><br>
                <span> Constatations :  [[resultat.items.0.client.constatations]] </span><br>
                <span> Attention :  [[resultat.items.0.client.attentions]] </span><br>
                <span> À ne pas masser :  [[resultat.items.0.client.pasMasser]] </span><br>
                <span> Note :  [[resultat.items.0.client.note]] </span><br>
                <span> Référé par :  [[resultat.items.0.client.refere]] </span><br>
                <span> Autres thérapies :  [[resultat.items.0.client.autresTherapies]] </span><br>
                <span> Médicaments :  [[resultat.items.0.client.medicaments]] </span><br>
                <span> Compléments :  [[resultat.items.0.client.complements]] </span><br>
                <span> Cardiaque :  [[resultat.items.0.client.cardiaque]] </span><br>
                <span> Asthme :  [[resultat.items.0.client.asthme]] </span><br>
                <span> Hypoglycémie :  [[resultat.items.0.client.hypoglycemie]] </span><br>
                <span> Diabète :  [[resultat.items.0.client.diabete]] </span><br>
                <span> Problème de peau :  [[resultat.items.0.client.peau]] </span><br>
                <span> Fumeur :  [[resultat.items.0.client.fumeur]] </span><br>
                <span> Ostéoporose :  [[resultat.items.0.client.osteoporose]] </span><br>
                <span> Arthrose :  [[resultat.items.0.client.arthrose]] </span><br>
                <span> Constipation :  [[resultat.items.0.client.constipation]] </span><br>
                <span> Allergies :  [[resultat.items.0.client.allergies]] </span><br>
                <span> Opérations :  [[resultat.items.0.client.operations]] </span><br>

                <br><br><br>
            </div>
        </template>
    </dom-if>



<div>

    <iron-icon class="grayIcon" icon="supervisor-account" slot="item-icon"></iron-icon> Traitements
    <vaadin-grid on-active-item-changed="_onActiveItemChanged"
                 id="grid"
                 items="[[resultat.items.0.client.traitements]]"
                 size="200"
                 >

        <template class="row-details">
            <div class="details">
                <span>Traitement : [[item.traitement]]</span><br>
                <span>Conseils : [[item.conseils]]</span><br>
                <span>Commentaires : [[item.commentaires]]</span><br>
            </div>
        </template>
        <vaadin-grid-column width="50px">
            <template>[[formatDate(item.dateVisite)]]</template>
        </vaadin-grid-column>
        <vaadin-grid-column width="50px"><template>[[item.raison]]</template></vaadin-grid-column>
        <vaadin-grid-column width="50px"><template>[[item.login]]</template></vaadin-grid-column>
        <vaadin-grid-column width="50px"><template>[[item.prix]]$ ([[item.modePaiement]])</template></vaadin-grid-column>
    </vaadin-grid>


</div>




    </template>

    <script>
      class ElithClientdetail extends Polymer.Element {
        static get is () {
          return 'elith-clientdetail'
        }

        static get properties () {
          return {
            resultat: {
              type: Object,
              observer: '_resultatChanged',
            },
            hasResult: {
              type: Boolean,
            }

          }
        }

        ready(){
          super.ready();
        }


        _resultatChanged () {
          (this.resultat != null) ? this.hasResult = true : this.hasResult = false;
        }

        formatDate(date){
          return Elith.Utils.formatDate(date);
        }

        _onActiveItemChanged(e) {
             this.$.grid.expandedItems = [e.detail.value];
             console.log(this.$.grid.expandedItems);
        }

      }


      window.customElements.define(ElithClientdetail.is, ElithClientdetail)
    </script>
</dom-module>
